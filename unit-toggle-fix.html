<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Simple Unit Toggle Fix</title>
	</head>
	<body>
		<h1>Quick Fix for BMI Unit Toggle Issues</h1>

		<p>Add this JavaScript to the BMI calculator to fix the immediate issues:</p>

		<pre><code>
// Add to BMI calculator initialization after DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    // Quick fix for unit toggle initialization
    setTimeout(() => {
        const sharedValues = new window.SharedValues();
        const values = sharedValues.load();
        
        // Fix height unit toggle
        const heightButtons = document.querySelectorAll('.input-group:has(label[for="height"]) .unit-btn');
        heightButtons.forEach(btn => {
            btn.classList.remove('active');
            if (btn.getAttribute('data-unit') === values.heightUnit) {
                btn.classList.add('active');
            }
        });
        
        // Fix weight unit toggle
        const weightButtons = document.querySelectorAll('.input-group:has(label[for="weight"]) .unit-btn');
        weightButtons.forEach(btn => {
            btn.classList.remove('active');
            if (btn.getAttribute('data-unit') === values.weightUnit) {
                btn.classList.add('active');
            }
        });
        
        // Update range slider values
        const heightFeet = document.getElementById('height-feet');
        const heightInches = document.getElementById('height-inches');
        const heightCm = document.getElementById('height-cm');
        const weightLbs = document.getElementById('weight-lbs');
        const weightKg = document.getElementById('weight-kg');
        
        if (heightFeet) {
            heightFeet.value = values.heightFeet;
            const display = document.getElementById('height-feet-display');
            if (display) display.textContent = values.heightFeet;
        }
        
        if (heightInches) {
            heightInches.value = values.heightInches;
            const display = document.getElementById('height-inches-display');
            if (display) display.textContent = values.heightInches;
        }
        
        if (heightCm) {
            heightCm.value = values.heightCm;
            const display = document.getElementById('height-cm-display');
            if (display) display.textContent = values.heightCm;
        }
        
        if (weightLbs) {
            weightLbs.value = values.weightLbs;
            const display = document.getElementById('weight-lbs-display');
            if (display) display.textContent = values.weightLbs;
        }
        
        if (weightKg) {
            weightKg.value = values.weightKg;
            const display = document.getElementById('weight-kg-display');
            if (display) display.textContent = values.weightKg;
        }
        
    }, 200);
});

// Fix for unit change events to update range sliders
document.addEventListener('unit-toggle-change', function(event) {
    if (event.detail.attribute === 'unit') {
        const sharedValues = new window.SharedValues();
        
        // Determine which unit changed
        const unitToggle = event.target;
        const inputGroup = unitToggle.closest('.input-group');
        const label = inputGroup.querySelector('label');
        const labelText = label.textContent.toLowerCase();
        
        if (labelText.includes('height')) {
            sharedValues.set('heightUnit', event.detail.value);
            if (event.detail.value === 'metric') {
                sharedValues.syncHeightUnits('metric');
            } else {
                sharedValues.syncHeightUnits('imperial');
            }
        } else if (labelText.includes('weight')) {
            sharedValues.set('weightUnit', event.detail.value);
            if (event.detail.value === 'metric') {
                sharedValues.syncWeightUnits('metric');
            } else {
                sharedValues.syncWeightUnits('imperial');
            }
        }
        
        // Refresh all sliders
        const values = sharedValues.load();
        ['height-feet', 'height-inches', 'height-cm', 'weight-lbs', 'weight-kg'].forEach(id => {
            const slider = document.getElementById(id);
            const display = document.getElementById(id + '-display');
            if (slider && values[id.replace('-', '')]) {
                slider.value = values[id.replace('-', '')];
                if (display) display.textContent = values[id.replace('-', '')];
            }
        });
        
        // Show/hide appropriate input containers
        const heightInputs = document.querySelectorAll('.height-inputs');
        heightInputs.forEach(input => {
            if (input.classList.contains(values.heightUnit)) {
                input.style.display = 'flex';
            } else {
                input.style.display = 'none';
            }
        });
        
        const weightInputs = document.querySelectorAll('.weight-inputs');
        weightInputs.forEach(input => {
            if (input.classList.contains(values.weightUnit)) {
                input.style.display = 'block';
            } else {
                input.style.display = 'none';
            }
        });
    }
});
    </code></pre>

		<h2>Summary of Issues:</h2>
		<ol>
			<li>
				<strong>Unit buttons not showing correct selection on load:</strong> Fixed by reading
				SharedValues and setting active class
			</li>
			<li>
				<strong>Range sliders not updating when units change:</strong> Fixed by updating slider
				values and displays from SharedValues
			</li>
			<li>
				<strong>Input containers not showing/hiding properly:</strong> Fixed by updating display
				styles based on current unit
			</li>
		</ol>

		<p>This should resolve both issues you mentioned!</p>
	</body>
</html>
